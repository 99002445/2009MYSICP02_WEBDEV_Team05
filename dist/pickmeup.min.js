
(function (F, x) {
    "function" === typeof define && define.amd ? define(x) : "object" === typeof exports ? module.exports = x() : F.pickmeup = x()
})(this, function () {
    function F(a, b, c) {
        c = c || [];
        if (a instanceof Element) b.apply(b, [a].concat(c));
        else {
            var d, e;
            d = a.length;
            for (e = 0; e < d; ++e) b.apply(b, [a[e]].concat(c))
        }
    }

    function x(a) {
        F(a, function (a) {
            a.parentElement.removeChild(a)
        })
    }

    function J(a, b) {
        do a = a.parentElement; while (a && !B(a, b));
        return a
    }

    function B(a, b) {
        return (a.matches || a.webkitMatchesSelector || a.msMatchesSelector).call(a, b)
    }

    function n(a, b) {
        return a && a.classList.contains(b)
    }

    function g(a, b) {
        a.classList.add(b)
    }

    function t(a, b, c, d) {
        if (-1 !== c.indexOf(" ")) {
            c = c.split(" ");
            var e = c.length
                , g;
            for (g = 0; g < e; ++g) t(a, b, c[g], d)
        }
        else a.__pickmeup.events.push([b, c, d]), b.addEventListener(c, d)
    }

    function y(a, b, c, d) {
        var e, g, f;
        if (c && -1 !== c.indexOf(" "))
            for (e = c.split(" "), g = e.length, f = 0; f < g; ++f) y(a, b, e[f], d);
        else
            for (e = a.__pickmeup.events, g = e.length, f = 0; f < g; ++f) b && b != e[f][0] || c && c != e[f][1] || d && d != e[f][2] || e[f][0].removeEventListener(e[f][1], e[f][2])
    }

    function M(a) {
        a = a.getBoundingClientRect();
        return {
            top: a.top + window.pageYOffset - document.documentElement.clientTop
            , left: a.left + window.pageXOffset - document.documentElement.clientLeft
        }
    }

    function C(a, b, c) {
        var d = document.createEvent("Event");
        c && (d.detail = c);
        d.initEvent("pickmeup-" + b, !1, !0);
        return a.dispatchEvent(d)
    }

    function K(a) {
        a = new Date(a);
        for (var b = 28, c = a.getMonth(); a.getMonth() == c;) ++b, a.setDate(b);
        return b - 1
    }

    function z(a, b) {
        a.setDate(a.getDate() + b)
    }

    function q(a, b) {
        var c = a.getDate();
        a.setDate(1);
        a.setMonth(a.getMonth() + b);
        a.setDate(Math.min(c, K(a)))
    }

    function w(a, b) {
        var c = a.getDate();
        a.setDate(1);
        a.setFullYear(a.getFullYear() + b);
        a.setDate(Math.min(c, K(a)))
    }

    function N(a) {
        var b = a.__pickmeup.element
            , c = a.__pickmeup.options
            , d = Math.floor(c.calendars / 2)
            , e = c.date
            , G = c.current
            , f = c.min ? new Date(c.min) : null
            , l = c.max ? new Date(c.max) : null
            , k, m, p, v, r;
        f && (f.setDate(1), q(f, 1), z(f, -1));
        l && (l.setDate(1), q(l, 1), z(l, -1));
        x(Array.prototype.slice.call(b.querySelectorAll(".pmu-instance \x3e :not(nav)")));
        for (var h = 0; h < c.calendars; h++) {
            k = new Date(G);
            A(k);
            p = Array.prototype.slice.call(b.querySelectorAll(".pmu-instance"))[h];
            n(b, "pmu-view-years") ? (w(k, 12 * (h - d)), m = k.getFullYear() - 6 + " - " + (k.getFullYear() + 5)) : n(b, "pmu-view-months") ? (w(k, h - d), m = k.getFullYear()) : n(b, "pmu-view-days") && (q(k, h - d), m = D(k, c.title_format, c.locales[c.locale]));
            if (!r && l && (r = new Date(k), c.select_day ? q(r, c.calendars - 1) : c.select_month ? w(r, c.calendars - 1) : w(r, 12 * (c.calendars - 1)), r > l)) {
                --h;
                q(G, -1);
                r = void 0;
                continue
            }
            r = new Date(k);
            if (!v && (v = new Date(k), v.setDate(1), q(v, 1), z(v, -1), f && f > v)) {
                --h;
                q(G, 1);
                v = void 0;
                continue
            }
            p.querySelector(".pmu-month").textContent = m;
            var t = function (a) {
                    return "range" == c.mode && a >= (new Date(e[0])).getFullYear() && a <= (new Date(e[1])).getFullYear() || "multiple" == c.mode && -1 !== e.reduce(function (a, c) {
                        a.push((new Date(c)).getFullYear());
                        return a
                    }, []).indexOf(a) || (new Date(e)).getFullYear() == a
                }
                , u = function (a, b) {
                    var d = (new Date(e[0])).getFullYear()
                        , k = (new Date(e[1])).getFullYear()
                        , g = (new Date(e[0])).getMonth()
                        , f = (new Date(e[1])).getMonth();
                    return "range" == c.mode && (a > d && a < k || a > d && a == k && b <= f || a == d && a < k && b >= g || a == d && a == k && b >= g && b <= f) || "multiple" == c.mode && -1 !== e.reduce(function (a, c) {
                        c = new Date(c);
                        a.push(c.getFullYear() + "-" + c.getMonth());
                        return a
                    }, []).indexOf(a + "-" + b) || (new Date(e)).getFullYear() == a && (new Date(e)).getMonth() == b
                };
            (function () {
                var a = []
                    , b = k.getFullYear() - 6
                    , d = (new Date(c.min)).getFullYear()
                    , e = (new Date(c.max)).getFullYear()
                    , f, h, l;
                for (l = 0; 12 > l; ++l) f = b + l, h = document.createElement("div"), h.textContent = f, h.__pickmeup_year = f, c.min && f < d || c.max && f > e ? g(h, "pmu-disabled") : t(f) && g(h, "pmu-selected"), a.push(h);
                p.appendChild(c.instance_content_template(a, "pmu-years"))
            })();
            (function () {
                var a = []
                    , b = k.getFullYear()
                    , d = (new Date(c.min)).getFullYear()
                    , e = (new Date(c.min)).getMonth()
                    , f = (new Date(c.max)).getFullYear()
                    , h = (new Date(c.max)).getMonth()
                    , l, m;
                for (l = 0; 12 > l; ++l) m = document.createElement("div"), m.textContent = c.locales[c.locale].monthsShort[l], m.__pickmeup_month = l, m.__pickmeup_year = b, c.min && (b < d || l < e && b == d) || c.max && (b > f || l > h && b >= f) ? g(m, "pmu-disabled") : u(b, l) && g(m, "pmu-selected"), a.push(m);
                p.appendChild(c.instance_content_template(a, "pmu-months"))
            })();
            (function () {
                var a = []
                    , b = k.getMonth()
                    , d = A(new Date).valueOf()
                    , e, f, h, l, m;
                (function () {
                    k.setDate(1);
                    var a = (k.getDay() - c.first_day) % 7;
                    z(k, -(a + (0 > a ? 7 : 0)))
                })();
                for (e = 0; 42 > e; ++e) f = document.createElement("div"), f.textContent = k.getDate(), f.__pickmeup_day = k.getDate(), f.__pickmeup_month = k.getMonth(), f.__pickmeup_year = k.getFullYear(), b != k.getMonth() && g(f, "pmu-not-in-month"), 0 == k.getDay() ? g(f, "pmu-sunday") : 6 == k.getDay() && g(f, "pmu-saturday"), h = c.render(new Date(k)) || {}, l = k.valueOf(), m = c.min && c.min > k || c.max && c.max < k, selected = c.date.valueOf() == l || c.date instanceof Array && c.date.reduce(function (a, b) {
                    return a || l === b.valueOf()
                }, !1) || "range" == c.mode && l >= c.date[0] && l <= c.date[1], h.disabled || !("disabled" in h) && m ? g(f, "pmu-disabled") : (h.selected || !("selected" in h) && selected) && g(f, "pmu-selected"), l == d && g(f, "pmu-today"), h.class_name && h.class_name.split(" ").forEach(g.bind(f, f)), a.push(f), z(k, 1);
                p.appendChild(c.instance_content_template(a, "pmu-days"))
            })()
        }
        v.setDate(1);
        r.setDate(1);
        q(r, 1);
        z(r, -1);
        d = b.querySelector(".pmu-prev");
        b = b.querySelector(".pmu-next");
        d && (d.style.visibility = c.min && c.min >= v ? "hidden" : "visible");
        b && (b.style.visibility = c.max && c.max <= r ? "hidden" : "visible");
        C(a, "fill")
    }

 
